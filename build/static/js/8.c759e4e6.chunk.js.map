{"version":3,"sources":["app/seller/views/products/AddProduct.js"],"names":["AddProduct","initData","name","description","category","sizes","images","price","useToast","error","warn","success","info","inputFile","useRef","useState","data","setData","numberInStock","setSizes","setImages","shopId","setShopId","listShop","setListShop","useEffect","getShops","then","response","handleChange","e","target","value","handleInputChange","index","list","handleAddClick","className","onChange","map","shop","_id","htmlFor","type","id","placeholder","rows","xs","size","i","length","color","shape","onClick","splice","handleRemoveClick","image","formData","FormData","append","axios","post","secure_url","catch","err","console","uploadImage","files","ref","style","display","current","click","fluid","src","width","height","s","filter","log","deleteFile","event","preventDefault","postProduct","respone","message","setTimeout"],"mappings":"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","file":"static/js/8.c759e4e6.chunk.js","sourcesContent":["import React, { useState, useRef, useEffect } from \"react\";\nimport axios from \"axios\";\nimport { getShops, postProduct } from \"../../../../services/api/sellerApi\";\nimport {\n  CButton,\n  CCol,\n  CForm,\n  CFormInput,\n  CInputGroup,\n  CFormLabel,\n  CFormTextarea,\n  CInputGroupText,\n  CImage,\n  CRow,\n  CFormSelect,\n} from \"@coreui/react\";\nimport { useToast } from \"../../../../contexts/toast\";\n\nconst AddProduct = () => {\n  const initData = {\n    name: \"\",\n    description: \"\",\n    category: \"\",\n    sizes: [],\n    images: [],\n    price: \"\",\n  }\n  const { error, warn, info, success } = useToast();\n  const inputFile = useRef(null);\n  const [data, setData] = useState(initData);\n\n  const [sizes, setSizes] = useState([{ name: \"\", numberInStock: \"\" }]);\n  const [images, setImages] = useState([]);\n  const [shopId, setShopId] = useState(\"0\");\n  const [listShop, setListShop] = useState([]);\n  useEffect(() => {\n    getShops().then((response) => {\n      setListShop(response.data.data);\n    });\n  }, []);\n\n  //\n  const uploadImage = (image) => {\n      // Tạo một form data chứa dữ liệu gửi lên\n      const formData = new FormData();\n      // Hình ảnh cần upload\n      formData.append(\"file\", image);\n      // Tên preset vừa tạo ở bước 1\n      formData.append(\"upload_preset\", \"new_preset\");\n      // Tải ảnh lên cloudinary\n      // API: https://api.cloudinary.com/v1_1/{Cloudinary-Name}/image/upload\n      axios\n        .post(\n          \"https://api.cloudinary.com/v1_1/accomerce/image/upload\",\n          formData\n        )\n        .then((response) => {\n          //data.images.push(response.data.secure_url);\n          setImages([...images,response.data.secure_url ])\n        })\n        .catch((err) => console.error(err));\n    };\n\n  const handleSubmit = (event) => {\n    event.preventDefault();\n    data.images = images\n    if(shopId == 0) {\n      warn(\"Vui lòng chọn cửa hàng\")\n    }\n    else{\n      postProduct(shopId, data)\n      .then((respone) => {\n        if (respone.data.success == true) {\n          success(respone.data.message)\n          setTimeout(setData(initData),3000);\n        } else{\n          error(respone.data.message);\n        }\n      })\n      .catch((err) => {\n        error(err.response.data.message)\n      }\n        );\n    }\n  };\n\n  const handleChange = (e) =>\n    setData({ ...data, [e.target.name]: e.target.value });\n  // handle input change\n  const handleInputChange = (e, index) => {\n    const { name, value } = e.target;\n    const list = [...sizes];\n    list[index][name] = value;\n    setSizes(list);\n    data.sizes = sizes;\n  };\n\n  // handle click event of the Remove button\n  const handleRemoveClick = (index) => {\n    const list = [...sizes];\n    list.splice(index, 1);\n    setSizes(list);\n    data.sizes.splice(index, 1);\n  };\n  //console.log(data);\n  // handle click event of the Add button\n  const handleAddClick = () => {\n    setSizes([...sizes, { name: \"\", numberInStock: \"\" }]);\n  };\n\n  // const handleAddImage = (e) => {\n  //     setImages((images) => [...images, e.target.files[i]]);\n  // };\n\n  const onButtonClick = () => {\n    inputFile.current.click();\n  };\n\n  const deleteFile = (e) => {\n    const s = images.filter((image, index) => index !== e);\n    setImages(s);\n    console.log(s);\n  };\n  return (\n    <div>\n      <div className=\"mb-3\">\n        <CFormSelect\n          aria-label=\"Default select example\"\n          onChange={(e) => setShopId(e.target.value)}\n        >\n          <option value = \"0\">Chọn shop</option>\n          {listShop.map((shop) => {\n            return <option value={shop._id} key ={shop._id}>{shop.name}</option>;\n          })}\n        </CFormSelect>\n      </div>\n      <CForm className=\"row g-3\">\n        <div className=\"mb-3\">\n          <CFormLabel htmlFor=\"exampleFormControlInput1\">\n            Tên sản phẩm\n          </CFormLabel>\n          <CFormInput\n            type=\"text\"\n            id=\"exampleFormControlInput1\"\n            name=\"name\"\n            placeholder=\"Nhập tên sản phẩm\"\n            onChange={(e) => handleChange(e)}\n          />\n        </div>\n        <div className=\"mb-3\">\n          <CFormLabel htmlFor=\"exampleFormControlTextarea1\">\n            Mô tả sản phẩm\n          </CFormLabel>\n          <CFormTextarea\n            id=\"exampleFormControlTextarea1\"\n            rows=\"3\"\n            name=\"description\"\n            onChange={(e) => handleChange(e)}\n          ></CFormTextarea>\n        </div>\n        <div className=\"mb-3\">\n          <CFormLabel htmlFor=\"exampleFormControlInput1\">\n            Loại sản phẩm\n          </CFormLabel>\n          <CFormInput\n            type=\"text\"\n            id=\"exampleFormControlInput1\"\n            name=\"category\"\n            placeholder=\"Nhập loại mặt hàng mà bạn muốn đề xuất\"\n            onChange={(e) => handleChange(e)}\n          />\n        </div>\n        <CCol xs={12}>\n          <CFormLabel htmlFor=\"inputAddress\">Kích thước</CFormLabel>\n          {sizes.map((size, i) => {\n            return (\n              <div className=\"box\" key={i}>\n                <CRow>\n                  <CCol xs>\n                    <CFormInput\n                      name=\"name\"\n                      value={size.name}\n                      placeholder=\"Nhập kích thước\"\n                      onChange={(e) => handleInputChange(e, i)}\n                    />\n                  </CCol>\n                  <CCol xs>\n                    <CFormInput\n                      name=\"numberInStock\"\n                      value={size.numberInStock}\n                      placeholder=\"Nhập số lượng\"\n                      onChange={(e) => handleInputChange(e, i)}\n                    />\n                  </CCol>\n                </CRow>\n                {sizes.length - 1 === i && (\n                  <CButton\n                    color=\"dark\"\n                    shape=\"rounded-pill\"\n                    onClick={handleAddClick}\n                    size=\"sm\"\n                  >\n                    Thêm\n                  </CButton>\n                )}\n                {sizes.length !== 1 && (\n                  <CButton\n                    color=\"dark\"\n                    shape=\"rounded-pill\"\n                    size=\"sm\"\n                    onClick={() => handleRemoveClick(i)}\n                  >\n                    Xóa\n                  </CButton>\n                )}\n              </div>\n            );\n          })}\n        </CCol>\n        <CCol xs={12}>\n          <CFormInput\n            type=\"file\"\n            onChange={(e) => {\n              uploadImage(e.target.files[0])\n            }}\n            ref={inputFile}\n            style={{ display: \"none\" }}\n          />\n          <CButton onClick={onButtonClick}>Thêm ảnh</CButton>\n        </CCol>\n        <CCol xs={12}>\n          {images &&\n            images.map((image, index) => {\n              return (\n                <CImage\n                  fluid\n                  src={image}\n                  width={150}\n                  height={150}\n                  onClick={() => deleteFile(index)}\n                  key={index}\n                />\n              );\n            })}\n        </CCol>\n        <CInputGroup className=\"mb-3\">\n          <CInputGroupText>$</CInputGroupText>\n          <CFormInput\n            aria-label=\"Amount (to the nearest dollar)\"\n            name=\"price\"\n            onChange={(e) => handleChange(e)}\n          />\n          <CInputGroupText>VNĐ</CInputGroupText>\n        </CInputGroup>\n        <CCol xs={12}>\n          <CButton onClick={handleSubmit} type=\"submit\">\n            Đăng sản phẩm\n          </CButton>\n        </CCol>\n      </CForm>\n    </div>\n  );\n};\n\nexport default AddProduct;\n"],"sourceRoot":""}