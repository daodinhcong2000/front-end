{"version":3,"sources":["app/seller/views/products/AddProduct.js"],"names":["AddProduct","useToast","error","warn","success","info","inputFile","useRef","useState","name","description","category","sizes","images","price","originalPrice","data","setData","numberInStock","setSizes","setImages","shopId","setShopId","listShop","setListShop","useEffect","getShops","then","response","handleChange","e","target","value","handleInputChange","index","list","handleAddClick","length","className","onChange","map","shop","_id","htmlFor","type","id","placeholder","rows","xs","size","i","color","shape","onClick","splice","handleRemoveClick","image","formData","FormData","append","axios","post","secure_url","catch","err","console","uploadImage","files","ref","style","display","current","click","fluid","src","width","s","filter","log","deleteFile","event","preventDefault","postProduct","respone","message","window","location","reload"],"mappings":"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","file":"static/js/18.35e961e7.chunk.js","sourcesContent":["import React, { useState, useRef, useEffect } from 'react'\nimport axios from 'axios'\nimport { getShops, postProduct } from '../../../../services/api/sellerApi'\nimport {\n  CButton,\n  CCol,\n  CForm,\n  CFormInput,\n  CInputGroup,\n  CFormLabel,\n  CFormTextarea,\n  CInputGroupText,\n  CImage,\n  CRow,\n  CFormSelect\n} from '@coreui/react'\nimport { useToast } from '../../../../contexts/toast'\n\nconst AddProduct = () => {\n  const initData = {\n    name: '',\n    description: '',\n    category: '',\n    sizes: [],\n    images: [],\n    price: '',\n    originalPrice: ''\n  }\n  const { error, warn, info, success } = useToast()\n  const inputFile = useRef(null)\n  const [data, setData] = useState(initData)\n\n  const [sizes, setSizes] = useState([{ name: '', numberInStock: '' }])\n  const [images, setImages] = useState([])\n  const [shopId, setShopId] = useState('0')\n  const [listShop, setListShop] = useState([])\n  useEffect(() => {\n    getShops({}).then((response) => {\n      setListShop(response.data.data)\n    })\n  }, [shopId])\n\n  //\n  const uploadImage = (image) => {\n    // Tạo một form data chứa dữ liệu gửi lên\n    const formData = new FormData()\n    // Hình ảnh cần upload\n    formData.append('file', image)\n    // Tên preset vừa tạo ở bước 1\n    formData.append('upload_preset', 'new_preset')\n    // Tải ảnh lên cloudinary\n    // API: https://api.cloudinary.com/v1_1/{Cloudinary-Name}/image/upload\n    axios\n      .post('https://api.cloudinary.com/v1_1/accomerce/image/upload', formData)\n      .then((response) => {\n        //data.images.push(response.data.secure_url);\n        setImages([...images, response.data.secure_url])\n      })\n      .catch((err) => console.error(err))\n  }\n\n  const handleSubmit = (event) => {\n    event.preventDefault()\n    data.images = images\n    if (shopId == 0) {\n      warn('Vui lòng chọn cửa hàng')\n    } else {\n      postProduct(shopId, data)\n        .then((respone) => {\n          if (respone.data.success == true) {\n            success(respone.data.message)\n            window.location.reload(false)\n          } else {\n            error(respone.data.message)\n          }\n        })\n        .catch((err) => {\n          error(err.response.data.message)\n        })\n    }\n  }\n\n  const handleChange = (e) => setData({ ...data, [e.target.name]: e.target.value })\n  // handle input change\n  const handleInputChange = (e, index) => {\n    const { name, value } = e.target\n    const list = [...sizes]\n    list[index][name] = value\n    setSizes(list)\n    data.sizes = sizes\n  }\n\n  // handle click event of the Remove button\n  const handleRemoveClick = (index) => {\n    const list = [...sizes]\n    list.splice(index, 1)\n    setSizes(list)\n    data.sizes.splice(index, 1)\n  }\n\n  // handle click event of the Add button\n  const handleAddClick = () => {\n    if (sizes[sizes.length - 1].name == '' || sizes[sizes.length - 1].name == '') {\n      warn('Vui lòng điền đủ thông tin về kích thước trước khi thêm mới')\n    } else {\n      setSizes([...sizes, { name: '', numberInStock: '' }])\n    }\n  }\n\n  const onButtonClick = () => {\n    inputFile.current.click()\n  }\n\n  const deleteFile = (e) => {\n    const s = images.filter((image, index) => index !== e)\n    setImages(s)\n    console.log(s)\n  }\n  return (\n    <div>\n      <div className=\"mb-3\">\n        <CFormSelect aria-label=\"Default select example\" onChange={(e) => setShopId(e.target.value)}>\n          <option value=\"0\">Chọn shop</option>\n          {listShop.map((shop) => {\n            return (\n              <option value={shop._id} key={shop._id}>\n                {shop.name}\n              </option>\n            )\n          })}\n        </CFormSelect>\n      </div>\n      <CForm className=\"row g-3\">\n        <div className=\"mb-3\">\n          <CFormLabel htmlFor=\"exampleFormControlInput1\">Tên sản phẩm</CFormLabel>\n          <CFormInput\n            type=\"text\"\n            id=\"exampleFormControlInput1\"\n            name=\"name\"\n            placeholder=\"Nhập tên sản phẩm\"\n            onChange={(e) => handleChange(e)}\n          />\n        </div>\n        <div className=\"mb-3\">\n          <CFormLabel htmlFor=\"exampleFormControlInput1\">Loại sản phẩm</CFormLabel>\n          <CFormInput\n            type=\"text\"\n            id=\"exampleFormControlInput1\"\n            name=\"category\"\n            placeholder=\"Nhập loại mặt hàng mà bạn muốn đề xuất\"\n            onChange={(e) => handleChange(e)}\n            value={data.category}\n          />\n        </div>\n        <div className=\"mb-3\">\n          <CFormLabel htmlFor=\"exampleFormControlTextarea1\">Mô tả sản phẩm</CFormLabel>\n          <CFormTextarea\n            id=\"exampleFormControlTextarea1\"\n            rows=\"3\"\n            name=\"description\"\n            onChange={(e) => handleChange(e)}\n            value={data.description}\n          ></CFormTextarea>\n        </div>\n        <CCol xs={12}>\n          <CFormLabel htmlFor=\"inputAddress\">Kích thước</CFormLabel>\n          {sizes.map((size, i) => {\n            return (\n              <div className=\"box\" key={i} id=\"inputSize\">\n                <CRow>\n                  <CCol xs>\n                    <CFormInput\n                      name=\"name\"\n                      value={size.name}\n                      placeholder=\"Nhập kích thước\"\n                      onChange={(e) => handleInputChange(e, i)}\n                    />\n                  </CCol>\n                  <CCol xs>\n                    <CFormInput\n                      name=\"numberInStock\"\n                      value={size.numberInStock}\n                      placeholder=\"Nhập số lượng\"\n                      onChange={(e) => handleInputChange(e, i)}\n                    />\n                  </CCol>\n                </CRow>\n                {sizes.length - 1 === i && (\n                  <CButton color=\"dark\" shape=\"rounded-pill\" onClick={handleAddClick} size=\"sm\">\n                    Thêm\n                  </CButton>\n                )}\n                {sizes.length !== 1 && (\n                  <CButton color=\"dark\" shape=\"rounded-pill\" size=\"sm\" onClick={() => handleRemoveClick(i)}>\n                    Xóa\n                  </CButton>\n                )}\n              </div>\n            )\n          })}\n        </CCol>\n        <CCol xs={12}>\n          <CFormInput\n            type=\"file\"\n            onChange={(e) => {\n              uploadImage(e.target.files[0])\n            }}\n            ref={inputFile}\n            style={{ display: 'none' }}\n          />\n          <CButton onClick={onButtonClick} color=\"secondary\" shape=\"rounded-pill\">\n            Thêm ảnh\n          </CButton>\n        </CCol>\n        <CCol xs={12} id=\"imageShow\">\n          {images &&\n            images.map((image, index) => {\n              return (\n                <CImage\n                  fluid\n                  src={image}\n                  width={150}\n                  //height={150}\n                  onClick={() => deleteFile(index)}\n                  key={index}\n                />\n              )\n            })}\n        </CCol>\n        <div className=\"mb-3\">\n          <CRow>\n            <CCol xs>\n              <CFormLabel htmlFor=\"exampleFormControlInput1\">Giá bán</CFormLabel>\n              <CInputGroup>\n                <CFormInput\n                  aria-label=\"Amount (to the nearest dollar)\"\n                  name=\"price\"\n                  onChange={(e) => handleChange(e)}\n                  value={data.price}\n                />\n                <CInputGroupText>VNĐ</CInputGroupText>\n              </CInputGroup>\n            </CCol>\n            <CCol xs>\n              <CFormLabel htmlFor=\"exampleFormControlInput1\">Giá gốc</CFormLabel>\n              <CInputGroup>\n                <CFormInput\n                  type=\"text\"\n                  id=\"exampleFormControlInput1\"\n                  name=\"originalPrice\"\n                  placeholder=\"Nhập giá gốc sản phẩm của bạn\"\n                  onChange={(e) => handleChange(e)}\n                  value={data.originalPrice}\n                />\n                <CInputGroupText>VNĐ</CInputGroupText>\n              </CInputGroup>\n            </CCol>\n          </CRow>\n        </div>\n        <CCol xs={12}>\n          <CButton onClick={handleSubmit} type=\"submit\" color=\"primary\">\n            Đăng sản phẩm\n          </CButton>\n        </CCol>\n      </CForm>\n    </div>\n  )\n}\n\nexport default AddProduct\n"],"sourceRoot":""}