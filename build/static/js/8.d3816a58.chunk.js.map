{"version":3,"sources":["app/seller/views/products/AddProduct.js"],"names":["AddProduct","useToast","error","warn","success","info","inputFile","useRef","useState","name","description","category","sizes","images","price","data","setData","numberInStock","setSizes","setImages","shopId","setShopId","listShop","setListShop","useEffect","getShops","then","response","handleChange","e","target","value","handleInputChange","index","list","handleAddClick","length","className","onChange","map","shop","_id","htmlFor","type","id","placeholder","rows","xs","size","i","color","shape","onClick","splice","handleRemoveClick","image","formData","FormData","append","axios","post","secure_url","catch","err","console","uploadImage","files","ref","style","display","current","click","fluid","src","width","height","s","filter","log","deleteFile","event","preventDefault","postProduct","respone","message","window","location","reload"],"mappings":"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","file":"static/js/8.d3816a58.chunk.js","sourcesContent":["import React, { useState, useRef, useEffect } from \"react\";\nimport axios from \"axios\";\nimport { getShops, postProduct } from \"../../../../services/api/sellerApi\";\nimport {\n  CButton,\n  CCol,\n  CForm,\n  CFormInput,\n  CInputGroup,\n  CFormLabel,\n  CFormTextarea,\n  CInputGroupText,\n  CImage,\n  CRow,\n  CFormSelect,\n} from \"@coreui/react\";\nimport { useToast } from \"../../../../contexts/toast\";\n\nconst AddProduct = () => {\n  const initData = {\n    name: \"\",\n    description: \"\",\n    category: \"\",\n    sizes: [],\n    images: [],\n    price: \"\",\n  }\n  const { error, warn, info, success } = useToast();\n  const inputFile = useRef(null);\n  const [data, setData] = useState(initData);\n\n  const [sizes, setSizes] = useState([{ name: \"\", numberInStock: \"\" }]);\n  const [images, setImages] = useState([]);\n  const [shopId, setShopId] = useState(\"0\");\n  const [listShop, setListShop] = useState([]);\n  useEffect(() => {\n    getShops().then((response) => {\n      setListShop(response.data.data);\n    });\n  }, [shopId]);\n\n  //\n  const uploadImage = (image) => {\n      // Tạo một form data chứa dữ liệu gửi lên\n      const formData = new FormData();\n      // Hình ảnh cần upload\n      formData.append(\"file\", image);\n      // Tên preset vừa tạo ở bước 1\n      formData.append(\"upload_preset\", \"new_preset\");\n      // Tải ảnh lên cloudinary\n      // API: https://api.cloudinary.com/v1_1/{Cloudinary-Name}/image/upload\n      axios\n        .post(\n          \"https://api.cloudinary.com/v1_1/accomerce/image/upload\",\n          formData\n        )\n        .then((response) => {\n          //data.images.push(response.data.secure_url);\n          setImages([...images,response.data.secure_url ])\n        })\n        .catch((err) => console.error(err));\n    };\n\n  const handleSubmit = (event) => {\n    event.preventDefault();\n    data.images = images\n    if(shopId == 0) {\n      warn(\"Vui lòng chọn cửa hàng\")\n    }\n    else{\n      postProduct(shopId, data)\n      .then((respone) => {\n        if (respone.data.success == true) {\n          success(respone.data.message)\n          window.location.reload(false);\n        } else{\n          error(respone.data.message);\n        }\n      })\n      .catch((err) => {\n        error(err.response.data.message)\n      }\n        );\n    }\n  };\n\n  const handleChange = (e) =>\n    setData({ ...data, [e.target.name]: e.target.value });\n  // handle input change\n  const handleInputChange = (e, index) => {\n    const { name, value } = e.target;\n    const list = [...sizes];\n    list[index][name] = value;\n    setSizes(list);\n    data.sizes = sizes;\n  };\n\n  // handle click event of the Remove button\n  const handleRemoveClick = (index) => {\n    const list = [...sizes];\n    list.splice(index, 1);\n    setSizes(list);\n    data.sizes.splice(index, 1);\n  };\n\n  // handle click event of the Add button\n  const handleAddClick = () => {\n    if(sizes[sizes.length -1].name == '' || sizes[sizes.length -1].name == ''){\n      warn(\"Vui lòng điền đủ thông tin về kích thước trước khi thêm mới\")\n    }\n    else{\n      setSizes([...sizes, { name: \"\", numberInStock: \"\" }]);\n    }\n    \n  };\n\n  const onButtonClick = () => {\n    inputFile.current.click();\n  };\n\n  const deleteFile = (e) => {\n    const s = images.filter((image, index) => index !== e);\n    setImages(s);\n    console.log(s);\n  };\n  return (\n    <div>\n      <div className=\"mb-3\">\n        <CFormSelect\n          aria-label=\"Default select example\"\n          onChange={(e) => setShopId(e.target.value)}\n        >\n          <option value = \"0\">Chọn shop</option>\n          {listShop.map((shop) => {\n            return <option value={shop._id} key ={shop._id}>{shop.name}</option>;\n          })}\n        </CFormSelect>\n      </div>\n      <CForm className=\"row g-3\">\n        <div className=\"mb-3\">\n          <CFormLabel htmlFor=\"exampleFormControlInput1\">\n            Tên sản phẩm\n          </CFormLabel>\n          <CFormInput\n            type=\"text\"\n            id=\"exampleFormControlInput1\"\n            name=\"name\"\n            placeholder=\"Nhập tên sản phẩm\"\n            onChange={(e) => handleChange(e)}\n          />\n        </div>\n        <div className=\"mb-3\">\n          <CFormLabel htmlFor=\"exampleFormControlTextarea1\">\n            Mô tả sản phẩm\n          </CFormLabel>\n          <CFormTextarea\n            id=\"exampleFormControlTextarea1\"\n            rows=\"3\"\n            name=\"description\"\n            onChange={(e) => handleChange(e)}\n          ></CFormTextarea>\n        </div>\n        <div className=\"mb-3\">\n          <CFormLabel htmlFor=\"exampleFormControlInput1\">\n            Loại sản phẩm\n          </CFormLabel>\n          <CFormInput\n            type=\"text\"\n            id=\"exampleFormControlInput1\"\n            name=\"category\"\n            placeholder=\"Nhập loại mặt hàng mà bạn muốn đề xuất\"\n            onChange={(e) => handleChange(e)}\n          />\n        </div>\n        <CCol xs={12}>\n          <CFormLabel htmlFor=\"inputAddress\">Kích thước</CFormLabel>\n          {sizes.map((size, i) => {\n            return (\n              <div className=\"box\" key={i} id=\"inputSize\">\n                <CRow>\n                  <CCol xs>\n                    <CFormInput\n                      name=\"name\"\n                      value={size.name}\n                      placeholder=\"Nhập kích thước\"\n                      onChange={(e) => handleInputChange(e, i)}\n                    />\n                  </CCol>\n                  <CCol xs>\n                    <CFormInput\n                      name=\"numberInStock\"\n                      value={size.numberInStock}\n                      placeholder=\"Nhập số lượng\"\n                      onChange={(e) => handleInputChange(e, i)}\n                    />\n                  </CCol>\n                </CRow>\n                {sizes.length - 1 === i && (\n                  <CButton\n                    color=\"dark\"\n                    shape=\"rounded-pill\"\n                    onClick={handleAddClick}\n                    size=\"sm\"\n                  >\n                    Thêm\n                  </CButton>\n                )}\n                {sizes.length !== 1 && (\n                  <CButton\n                    color=\"dark\"\n                    shape=\"rounded-pill\"\n                    size=\"sm\"\n                    onClick={() => handleRemoveClick(i)}\n                  >\n                    Xóa\n                  </CButton>\n                )}\n              </div>\n            );\n          })}\n        </CCol>\n        <CCol xs={12}>\n          <CFormInput\n            type=\"file\"\n            onChange={(e) => {\n              uploadImage(e.target.files[0])\n            }}\n            ref={inputFile}\n            style={{ display: \"none\" }}\n          />\n          <CButton onClick={onButtonClick}>Thêm ảnh</CButton>\n        </CCol>\n        <CCol xs={12} id=\"imageShow\">\n          {images &&\n            images.map((image, index) => {\n              return (\n                <CImage\n                  fluid\n                  src={image}\n                  width={150}\n                  height={150}\n                  onClick={() => deleteFile(index)}\n                  key={index}\n                />\n              );\n            })}\n        </CCol>\n        <CInputGroup className=\"mb-3\">\n          <CInputGroupText>$</CInputGroupText>\n          <CFormInput\n            aria-label=\"Amount (to the nearest dollar)\"\n            name=\"price\"\n            onChange={(e) => handleChange(e)}\n          />\n          <CInputGroupText>VNĐ</CInputGroupText>\n        </CInputGroup>\n        <CCol xs={12}>\n          <CButton onClick={handleSubmit} type=\"submit\">\n            Đăng sản phẩm\n          </CButton>\n        </CCol>\n      </CForm>\n    </div>\n  );\n};\n\nexport default AddProduct;\n"],"sourceRoot":""}