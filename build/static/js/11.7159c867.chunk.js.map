{"version":3,"sources":["services/api/adminApi.js","app/admin/views/shops/ListShop.js"],"names":["apiRequest","makeAuthRequest","urlUser","urlAdmin","urlStatistics","getUsers","query","queryString","query2string","url","method","putActiveUser","idUser","payload","data","deleteUser","getShops","putApproved","idShop","putActiveShop","deleteShop","getRevenue","getRevenueSeller","idSeller","getRevenueShop","getRevenueCustomer","idCustomer","confirm","Modal","ListUsersDetail","useToast","error","success","warn","info","useState","details","setDetails","loading","setLoading","listShops","setListShops","useEffect","then","response","map","i","_id","getBadge","role","handleApproved","status","approvalStatus","respone","message","catch","err","showDeleteConfirm","title","icon","style","top","okText","okType","cancelText","onOk","handleDelete","onCancel","activePage","cleaner","clickableRows","columns","label","key","_style","width","_props","className","filter","sorter","color","columnFilter","columnSorter","noItemsLabel","items","itemsPerPageSelect","itemsPerPage","pagination","scopedColumns","email","item","show_details","variant","shape","size","onClick","index","event","preventDefault","position","indexOf","newDetails","slice","splice","toggleDetails","includes","visible","xs","htmlFor","name","disabled","value","seller","username","isActive","shop","changeStatus","sorterValue","column","state","tableFilter","tableProps","striped","hover"],"mappings":"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","file":"static/js/11.7159c867.chunk.js","sourcesContent":["import { makeAuthRequest } from '../makeApiRequest'\nconst apiRequest = makeAuthRequest(true)\nimport query2string from '../../helpers/validating/query2string'\nconst urlUser = '/user-service/api'\nconst urlAdmin = '/admin-service/api'\nconst urlStatistics = '/statistics-service/api'\nexport const getUsers = (query) => {\n  const queryString = query2string(query)\n  return apiRequest({\n    url: `${urlUser}/users?${queryString}`,\n    method: 'GET'\n  })\n}\n\nexport const putActiveUser = (idUser, payload) => {\n  return apiRequest({\n    url: `${urlUser}/users/${idUser}`,\n    method: 'PUT',\n    data: payload\n  })\n}\n\nexport const deleteUser = (idUser) => {\n  return apiRequest({\n    url: `${urlUser}/users/${idUser}`,\n    method: 'DELETE'\n  })\n}\n\nexport const getShops = (query) => {\n  const queryString = ''\n  if (query != null) {\n    const queryString = query2string(query)\n  }\n\n  return apiRequest({\n    url: `${urlAdmin}/shops?${queryString}`,\n    method: 'GET'\n  })\n}\n\nexport const putApproved = (idShop, payload) => {\n  return apiRequest({\n    url: `${urlAdmin}/shops/${idShop}/approval`,\n    method: 'PUT',\n    data: payload\n  })\n}\n\nexport const putActiveShop = (idShop, payload) => {\n  return apiRequest({\n    url: `${urlAdmin}/shops/${idShop}/active-status`,\n    method: 'PUT',\n    data: payload\n  })\n}\n\nexport const deleteShop = (idShop) => {\n  return apiRequest({\n    url: `${urlAdmin}/shops/${idShop}`,\n    method: 'DELETE'\n  })\n}\n\nexport const getRevenue = (query) => {\n  const queryString = query2string(query)\n  return apiRequest({\n    url: `${urlStatistics}/order-statistics?${queryString}`,\n    method: 'GET'\n  })\n}\n\nexport const getRevenueSeller = (idSeller, query) => {\n  const queryString = query2string(query)\n  return apiRequest({\n    url: `${urlStatistics}/sellers/${idSeller}/order-statistics?${queryString}`,\n    method: 'GET'\n  })\n}\n\nexport const getRevenueShop = (idShop, query) => {\n  const queryString = query2string(query)\n  return apiRequest({\n    url: `${urlStatistics}/shops/${idShop}/order-statistics?${queryString}`,\n    method: 'GET'\n  })\n}\n\nexport const getRevenueCustomer = (idCustomer, query) => {\n  const queryString = query2string(query)\n  return apiRequest({\n    url: `${urlStatistics}/customers/${idCustomer}/order-statistics?${queryString}`,\n    method: 'GET'\n  })\n}\n","import React, { useState, useEffect } from 'react'\nimport { getShops, putApproved, putActiveShop, deleteShop } from '../../../../services/api/adminApi'\nimport { CSmartTable, CBadge, CButton, CCollapse, CCardBody } from '@coreui/react-pro'\nimport { CCol, CFormInput, CFormLabel, CRow } from '@coreui/react'\nimport { useToast } from '../../../../contexts/toast'\nimport { Modal } from 'antd'\nimport { ExclamationCircleOutlined } from '@ant-design/icons'\n\nconst { confirm } = Modal\nconst ListUsersDetail = () => {\n  const { error, warn, info, success } = useToast()\n  const [details, setDetails] = useState([])\n  const [loading, setLoading] = useState(true)\n  const columns = [\n    {\n      label: 'Tên cửa hàng',\n      key: 'name',\n      _style: { width: '40%' },\n      _props: { className: 'fw-semibold' }\n    },\n    {\n      label: 'Email',\n      key: 'email'\n    },\n    {\n      label: 'Địa chỉ',\n      key: 'address',\n      filter: true,\n      sorter: false,\n      _style: { width: '20%' }\n    },\n    { label: 'Trạng thái phê duyệt', filter: true, key: 'approvalStatus', _style: { width: '20%' } },\n    {\n      key: 'show_details',\n      label: '',\n      _style: { width: '1%' },\n      filter: false,\n      sorter: false,\n      _props: { color: 'primary', className: 'fw-semibold' }\n    }\n  ]\n  const [listShops, setListShops] = useState([])\n  useEffect(() => {\n    getShops().then((response) => {\n      response.data.data.map((data, i) => {\n        data.idShop = data._id\n      })\n      setListShops(response.data.data)\n      setLoading(false)\n    })\n  }, [loading])\n\n  const getBadge = (role) => {\n    switch (role) {\n      case 'approved':\n        return 'success'\n      case 'pending':\n        return 'warning'\n      case 'rejected':\n        return 'danger'\n      default:\n        return 'primary'\n    }\n  }\n\n  const toggleDetails = (index) => {\n    event.preventDefault()\n    const position = details.indexOf(index)\n    let newDetails = details.slice()\n    if (position !== -1) {\n      newDetails.splice(position, 1)\n    } else {\n      newDetails = [...details, index]\n    }\n    setDetails(newDetails)\n  }\n\n  const handleApproved = (idShop, status) => {\n    const approvalStatus = {\n      approvalStatus: status\n    }\n    putApproved(idShop, approvalStatus)\n      .then((respone) => {\n        success(respone.data.message)\n        setLoading(false)\n      })\n      .catch((err) => {\n        error(err.response.data.message)\n        setLoading(false)\n      })\n  }\n\n  const changeStatus = (shop) => {\n    const status = {\n      isActive: !shop.isActive\n    }\n    putActiveShop(shop.idShop, status)\n      .then((respone) => {\n        success(respone.data.message)\n        setLoading(false)\n      })\n      .catch((err) => {\n        error(err.response.data.message)\n        setLoading(false)\n      })\n  }\n\n  const handleDelete = (idShop) => {\n    deleteShop(idShop)\n      .then((respone) => {\n        success(respone.data.message)\n        setLoading(false)\n      })\n      .catch((err) => {\n        error(err.response.data.message)\n        setLoading(false)\n      })\n  }\n\n  const showDeleteConfirm = (idShop) => {\n    confirm({\n      title: 'Bạn chắc chắn muốn xóa cửa hàng này?',\n      icon: <ExclamationCircleOutlined />,\n      style: { top: 200 },\n      okText: 'Đồng ý',\n      okType: 'danger',\n      cancelText: 'Quay lại',\n      onOk() {\n        handleDelete(idShop)\n        setLoading(true)\n      },\n      onCancel() {\n        setLoading(false)\n      }\n    })\n  }\n\n  const showRejectConfirm = (idShop) => {\n    confirm({\n      title: 'Bạn chắc chắn muốn từ chối cửa hàng này?',\n      icon: <ExclamationCircleOutlined />,\n      style: { top: 200 },\n      okText: 'Đồng ý',\n      okType: 'danger',\n      cancelText: 'Quay lại',\n      onOk() {\n        handleApproved(idShop, 'rejected')\n        setLoading(true)\n      },\n      onCancel() {\n        setLoading(false)\n      }\n    })\n  }\n  return (\n    <div>\n      <CSmartTable\n        activePage={3}\n        cleaner\n        clickableRows\n        columns={columns}\n        columnFilter\n        columnSorter\n        loading={loading}\n        noItemsLabel=\"Chưa có cửa hàng nào\"\n        items={listShops}\n        itemsPerPageSelect\n        itemsPerPage={5}\n        pagination\n        scopedColumns={{\n          email: (item) => <td>{item.email != '' ? item.email : ''}</td>,\n          approvalStatus: (item) => (\n            <td>\n              <CBadge color={getBadge(item.approvalStatus)}>{item.approvalStatus}</CBadge>\n            </td>\n          ),\n          show_details: (item) => {\n            return (\n              <td className=\"py-2\">\n                <CButton\n                  variant=\"outline\"\n                  shape=\"square\"\n                  size=\"sm\"\n                  onClick={() => {\n                    toggleDetails(item._id)\n                  }}\n                >\n                  {details.includes(item._id) ? 'Hide' : 'Show'}\n                </CButton>\n              </td>\n            )\n          },\n          details: (item) => {\n            return (\n              <CCollapse visible={details.includes(item._id)}>\n                <CCardBody>\n                  <div className=\"mb-3\">\n                    <CRow>\n                      <CCol xs>\n                        <CFormLabel htmlFor=\"exampleFormControlInput1\">Người quản lý</CFormLabel>\n                        <CFormInput\n                          aria-label=\"Amount (to the nearest dollar)\"\n                          name=\"price\"\n                          disabled\n                          value={item.seller.username}\n                        />\n                      </CCol>\n                      <CCol xs></CCol>\n                    </CRow>\n                  </div>\n                  <div className=\"mb-3\">\n                    <CRow>\n                      <CCol xs>\n                        <CFormLabel htmlFor=\"exampleFormControlInput1\">Trạng thái hoạt động:</CFormLabel>\n                        {item.isActive ? (\n                          <CButton color=\"success\" variant=\"outline\" disabled>\n                            Đã kích hoạt\n                          </CButton>\n                        ) : (\n                          <CButton disabled color=\"danger\" variant=\"outline\">\n                            Chưa kích hoạt\n                          </CButton>\n                        )}\n                      </CCol>\n                      <CCol xs>\n                        <CButton\n                          color=\"info\"\n                          variant=\"outline\"\n                          disabled={loading}\n                          onClick={() => {\n                            setLoading(true)\n                            changeStatus(item)\n                          }}\n                        >\n                          Đổi trạng thái\n                        </CButton>\n                      </CCol>\n                    </CRow>\n                  </div>\n                  <div className=\"mb-3\">\n                    {item.approvalStatus == 'pending' ? (\n                      <CRow>\n                        <CCol xs>\n                          <CButton\n                            color=\"success\"\n                            disabled={loading}\n                            shape=\"rounded-pill\"\n                            onClick={() => {\n                              setLoading(true)\n                              handleApproved(item.idShop, 'approved')\n                            }}\n                          >\n                            Phê duyệt\n                          </CButton>\n                        </CCol>\n                        <CCol xs>\n                          <CButton\n                            disabled={loading}\n                            color=\"danger\"\n                            shape=\"rounded-pill\"\n                            onClick={() => {\n                              showRejectConfirm(item.idShop)\n                            }}\n                          >\n                            Từ chối\n                          </CButton>\n                        </CCol>\n                      </CRow>\n                    ) : (\n                      ''\n                    )}\n                  </div>\n                  <div className=\"mb-3\">\n                    {item.approvalStatus == 'approved' ? (\n                      <CCol xs>\n                        <CButton\n                          disabled={loading}\n                          color=\"danger\"\n                          shape=\"rounded-pill\"\n                          onClick={() => showDeleteConfirm(item.idShop)}\n                        >\n                          Xóa cửa hàng\n                        </CButton>\n                      </CCol>\n                    ) : (\n                      ''\n                    )}\n                  </div>\n                </CCardBody>\n              </CCollapse>\n            )\n          }\n        }}\n        sorterValue={{ column: 'name', state: 'asc' }}\n        tableFilter\n        tableProps={{\n          striped: true,\n          hover: true\n        }}\n      />\n    </div>\n  )\n}\n\nexport default ListUsersDetail\n"],"sourceRoot":""}