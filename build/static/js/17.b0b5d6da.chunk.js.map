{"version":3,"sources":["app/seller/views/products/AddProduct.js"],"names":["AddProduct","style","color","useToast","error","warn","success","info","inputFile","useRef","useState","name","description","category","sizes","images","price","originalPrice","data","setData","numberInStock","setSizes","setImages","shopId","setShopId","listShop","setListShop","loading","setLoading","useEffect","getShops","then","response","handleChange","e","target","value","handleInputChange","index","list","handleAddClick","length","className","onChange","map","shop","_id","htmlFor","type","id","placeholder","rows","xs","size","i","shape","onClick","splice","handleRemoveClick","image","formData","FormData","append","axios","post","secure_url","catch","err","console","uploadImage","files","ref","display","current","click","fluid","src","width","s","filter","log","deleteFile","disabled","event","preventDefault","postProduct","respone","message","window","location","reload","component"],"mappings":"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","file":"static/js/17.b0b5d6da.chunk.js","sourcesContent":["import React, { useState, useRef, useEffect } from 'react'\nimport axios from 'axios'\nimport { getShops, postProduct } from '../../../../services/api/sellerApi'\nimport {\n  CButton,\n  CCol,\n  CForm,\n  CFormInput,\n  CInputGroup,\n  CFormLabel,\n  CFormTextarea,\n  CInputGroupText,\n  CImage,\n  CRow,\n  CFormSelect,\n  CSpinner\n} from '@coreui/react'\nimport { useToast } from '../../../../contexts/toast'\n\nconst AddProduct = () => {\n  const style = { color: 'red' }\n  const initData = {\n    name: '',\n    description: '',\n    category: '',\n    sizes: [],\n    images: [],\n    price: '',\n    originalPrice: ''\n  }\n  const { error, warn, info, success } = useToast()\n  const inputFile = useRef(null)\n  const [data, setData] = useState(initData)\n\n  const [sizes, setSizes] = useState([{ name: '', numberInStock: '' }])\n  const [images, setImages] = useState([])\n  const [shopId, setShopId] = useState('0')\n  const [listShop, setListShop] = useState([])\n  const [loading, setLoading] = useState(false)\n\n  useEffect(() => {\n    getShops({}).then((response) => {\n      setListShop(response.data.data)\n    })\n  }, [shopId])\n\n  //\n  const uploadImage = (image) => {\n    // Tạo một form data chứa dữ liệu gửi lên\n    const formData = new FormData()\n    // Hình ảnh cần upload\n    formData.append('file', image)\n    // Tên preset vừa tạo ở bước 1\n    formData.append('upload_preset', 'new_preset')\n    // Tải ảnh lên cloudinary\n    // API: https://api.cloudinary.com/v1_1/{Cloudinary-Name}/image/upload\n    axios\n      .post('https://api.cloudinary.com/v1_1/accomerce/image/upload', formData)\n      .then((response) => {\n        //data.images.push(response.data.secure_url);\n        setImages([...images, response.data.secure_url])\n      })\n      .catch((err) => console.error(err))\n  }\n\n  const handleSubmit = (event) => {\n    event.preventDefault()\n    setLoading(true)\n    data.images = images\n    if (shopId == 0) {\n      warn('Vui lòng chọn cửa hàng')\n      setLoading(false)\n    } else if (data.sizes.length == 0) {\n      warn('Sản phẩm cần tối thiểu một loại hàng')\n      setLoading(false)\n    } else {\n      postProduct(shopId, data)\n        .then((respone) => {\n          if (respone.data.success == true) {\n            success(respone.data.message)\n            window.location.reload(false)\n          } else {\n            error(respone.data.message)\n          }\n        })\n        .catch((err) => {\n          error(err.response.data.message)\n          setLoading(false)\n        })\n    }\n  }\n\n  const handleChange = (e) => setData({ ...data, [e.target.name]: e.target.value })\n  // handle input change\n  const handleInputChange = (e, index) => {\n    const { name, value } = e.target\n    const list = [...sizes]\n    list[index][name] = value\n    setSizes(list)\n    data.sizes = sizes\n  }\n\n  // handle click event of the Remove button\n  const handleRemoveClick = (index) => {\n    const list = [...sizes]\n    list.splice(index, 1)\n    setSizes(list)\n    data.sizes.splice(index, 1)\n  }\n\n  // handle click event of the Add button\n  const handleAddClick = () => {\n    if (sizes[sizes.length - 1].name == '' || sizes[sizes.length - 1].name == '') {\n      warn('Vui lòng điền đủ thông tin về kích thước trước khi thêm mới')\n    } else {\n      setSizes([...sizes, { name: '', numberInStock: '' }])\n    }\n  }\n\n  const onButtonClick = () => {\n    inputFile.current.click()\n  }\n\n  const deleteFile = (e) => {\n    const s = images.filter((image, index) => index !== e)\n    setImages(s)\n    console.log(s)\n  }\n  return (\n    <div>\n      <div className=\"mb-3\">\n        <CFormSelect aria-label=\"Default select example\" onChange={(e) => setShopId(e.target.value)}>\n          <option value=\"0\">Chọn shop</option>\n          {listShop.map((shop) => {\n            return (\n              <option value={shop._id} key={shop._id}>\n                {shop.name}\n              </option>\n            )\n          })}\n        </CFormSelect>\n      </div>\n      <CForm className=\"row g-3\">\n        <div className=\"mb-3\">\n          <CFormLabel htmlFor=\"exampleFormControlInput1\">\n            Tên sản phẩm <span style={style}>*</span>\n          </CFormLabel>\n          <CFormInput\n            type=\"text\"\n            id=\"exampleFormControlInput1\"\n            name=\"name\"\n            placeholder=\"Nhập tên sản phẩm\"\n            onChange={(e) => handleChange(e)}\n          />\n        </div>\n        <div className=\"mb-3\">\n          <CFormLabel htmlFor=\"exampleFormControlInput1\">\n            Loại sản phẩm <span style={style}>*</span>\n          </CFormLabel>\n          <CFormInput\n            type=\"text\"\n            id=\"exampleFormControlInput1\"\n            name=\"category\"\n            placeholder=\"Nhập loại mặt hàng mà bạn muốn đề xuất\"\n            onChange={(e) => handleChange(e)}\n            value={data.category}\n          />\n        </div>\n        <div className=\"mb-3\">\n          <CFormLabel htmlFor=\"exampleFormControlTextarea1\">\n            Mô tả sản phẩm <span style={style}>*</span>\n          </CFormLabel>\n          <CFormTextarea\n            id=\"exampleFormControlTextarea1\"\n            rows=\"3\"\n            name=\"description\"\n            onChange={(e) => handleChange(e)}\n            placeholder=\"Mô tả chi tiết về sản phẩm của bạn\"\n            value={data.description}\n          ></CFormTextarea>\n        </div>\n        <CCol xs={12}>\n          <CFormLabel htmlFor=\"inputAddress\">\n            Phân loại hàng <span style={style}>*</span>\n          </CFormLabel>\n          {sizes.map((size, i) => {\n            return (\n              <div key={i} id=\"inputSize\">\n                <CRow>\n                  <CCol xs>\n                    <CFormInput\n                      name=\"name\"\n                      value={size.name}\n                      placeholder=\"Nhập tên loại hàng\"\n                      onChange={(e) => handleInputChange(e, i)}\n                    />\n                  </CCol>\n                  <CCol xs>\n                    <CFormInput\n                      name=\"numberInStock\"\n                      value={size.numberInStock}\n                      placeholder=\"Nhập số lượng hàng\"\n                      onChange={(e) => handleInputChange(e, i)}\n                    />\n                  </CCol>\n                </CRow>\n                {sizes.length - 1 === i && (\n                  <CButton color=\"dark\" shape=\"rounded-pill\" onClick={handleAddClick} size=\"sm\">\n                    Thêm\n                  </CButton>\n                )}\n                {sizes.length !== 1 && (\n                  <CButton color=\"dark\" shape=\"rounded-pill\" size=\"sm\" onClick={() => handleRemoveClick(i)}>\n                    Xóa\n                  </CButton>\n                )}\n              </div>\n            )\n          })}\n        </CCol>\n        <CCol xs={12}>\n          <CFormInput\n            type=\"file\"\n            onChange={(e) => {\n              uploadImage(e.target.files[0])\n            }}\n            ref={inputFile}\n            style={{ display: 'none' }}\n          />\n          <CButton onClick={onButtonClick} color=\"secondary\" shape=\"rounded-pill\">\n            Thêm ảnh <span style={style}>*</span>\n          </CButton>\n        </CCol>\n        <CCol xs={12} id=\"imageShow\">\n          {images &&\n            images.map((image, index) => {\n              return <CImage fluid src={image} width={150} onClick={() => deleteFile(index)} key={index} />\n            })}\n        </CCol>\n        <div className=\"mb-3\">\n          <CRow>\n            <CCol xs>\n              <CFormLabel htmlFor=\"exampleFormControlInput1\">\n                Giá bán <span style={style}>*</span>\n              </CFormLabel>\n              <CInputGroup>\n                <CFormInput\n                  aria-label=\"Amount (to the nearest dollar)\"\n                  name=\"price\"\n                  onChange={(e) => handleChange(e)}\n                  placeholder=\"Nhập giá bán sản phẩm của bạn\"\n                  value={data.price}\n                />\n                <CInputGroupText>VNĐ</CInputGroupText>\n              </CInputGroup>\n            </CCol>\n            <CCol xs>\n              <CFormLabel htmlFor=\"exampleFormControlInput1\">\n                Giá gốc <span style={style}>*</span>\n              </CFormLabel>\n              <CInputGroup>\n                <CFormInput\n                  type=\"text\"\n                  id=\"exampleFormControlInput1\"\n                  name=\"originalPrice\"\n                  placeholder=\"Nhập giá gốc sản phẩm của bạn\"\n                  onChange={(e) => handleChange(e)}\n                  value={data.originalPrice}\n                />\n                <CInputGroupText>VNĐ</CInputGroupText>\n              </CInputGroup>\n            </CCol>\n          </CRow>\n        </div>\n        <CCol xs={12}>\n          <CButton disabled={loading} onClick={handleSubmit} type=\"submit\" color=\"primary\">\n            {!loading ? '' : <CSpinner component=\"span\" size=\"sm\" aria-hidden=\"true\" />}\n            Đăng sản phẩm\n          </CButton>\n        </CCol>\n      </CForm>\n    </div>\n  )\n}\n\nexport default AddProduct\n"],"sourceRoot":""}